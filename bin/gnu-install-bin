#! /usr/bin/env ruby

require 'optparse'

options = {show_help: false, debug: false}

begin

  # rootpath = File.dirname(File.dirname(__FILE__))
  # $: << File.join(rootpath,'lib')

  $stderr.print "gnu-install-bin 0.0.1-pre1 Copyright (C) 2016-2017 Pjotr Prins <pjotr.prins@thebird.nl>\n\n"
  USAGE =<<EOU

  gnu-install-bin is a one-click binary software installer

EOU

  opts = OptionParser.new do |o|
    o.banner = "Usage: #{File.basename($0)} [options] [target-dir]\n\n"

    o.separator "\n\tVerbosity:\n\n"

    o.on("-q", "--quiet", "Run quietly") do |q|
      options[:quiet] = q
    end

    o.on("-v", "--verbose", "Run verbosely") do |v|
      options[:verbose] = v
    end

    o.on("--debug", "Show debug messages") do |v|
      Bio::Log::CLI.trace('debug')
      options[:debug] = true
    end

    o.separator ""

    o.on_tail('-h', '--help', 'Display this help and exit') do
      options[:show_help] = true
    end
  end

  begin
    opts.parse!(ARGV)

    if options[:show_help]
      print opts
      print USAGE
    end

  rescue OptionParser::InvalidOption => e
    options[:invalid_argument] = e.message
  end

rescue => msg
  if options[:debug]
    raise
  else
    $stderr.print "Error: ",msg,"\n"
    exit 1
  end
end
